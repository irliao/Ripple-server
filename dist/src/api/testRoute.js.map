{"version":3,"sources":["src/api/testRoute.js"],"names":[],"mappings":"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","file":"src/api/testRoute.js","sourcesContent":["var S3 = require('./service/uploader');\nvar Pubnub   = require('./service/pubnub');\nvar express = require('express');\nvar test = express.Router();\nvar mongoose     = require( 'mongoose' );\nvar MOMENT = require('./moment/moModel');\nvar DEVICE = require('./device/deModel');\nvar ACTOR = require('./actor');\n\ntest.route('/cleardb')\n    .post( function(req, res)\n    {\n        mongoose.connection.collections['actors'].drop( function(err) {\n            console.log('collection dropped');\n            ACTOR.ensureIndexes(function(){\n              console.log('Index ensured');\n            });\n        });\n        mongoose.connection.collections['devices'].drop( function(err) {\n            console.log('collection dropped');\n            DEVICE.ensureIndexes(function(){\n              console.log('Index ensured');\n               setTimeout(function()\n                      {\n                         res.json(\n                                {\n                                    status:'db cleared.'\n                                })\n                      },1500);\n            });\n        });\n        mongoose.connection.collections['moments'].drop( function(err) {\n            console.log('collection dropped');\n            MOMENT.ensureIndexes(function(){\n              console.log('Index ensured');\n\n            });\n\n        });\n\n\n    });\n\ntest.route('/5frds')\n    .post( function( req, res )\n    {\n\n        Pubnub.fivefrds( req.body.channel, function(auth_key,deny1,deny2,allow1,allow2,allow3){\n            res.json(\n                    {\n                        auth_key: auth_key,\n                        friends: [\n                            {\n                                channel_id: deny1,\n                                nick_name: \"michael_deny\"\n                            },\n                            {\n                                channel_id: allow1,\n                                nick_name: \"apple_allow\"\n                            },\n\n                            {\n                                channel_id: deny2,\n                                nick_name: \"annie_deny\"\n                            },\n                            {\n                                channel_id: allow2,\n                                nick_name: \"kazumi_allow\"\n                            },\n\n                            {\n                                channel_id: allow3,\n                                nick_name: \"lala_allow\"\n                            },\n                        ]\n                    });\n        });\n    });\n\ntest.route('/initdb')\n    .post(function(req,res){\n\n    });\ntest.route('/pub')\n    .post( function( req, res )\n    {\n        console.log( \"pubb\");\n        Pubnub.pub( req.body.channel, 'hi' ,function(){\n            res.status(200);\n        });\n    });\n\n\ntest.route('/grant')\n    .post( function( req, res )\n    {\n        console.log( \"pubb\");\n        console.log( req.body.channel );\n        Pubnub.grant( req.body.channel, function(msg, obj)\n        {\n              res.json(\n                    {\n                        status : msg,\n                        feedback: obj\n                    });\n        });\n\n    });\n\ntest.route('/sub')\n    .post( function(req, res)\n    {\n        console.log( \"pubb\");\n        Pubnub.subTest(req.body.channel, req.body.msg,function(){\n                  res.json(\n                    {\n\n                    });\n        });\n    });\n\ntest.route('/')\n    .get( function(req, res)\n    {\n        res.json(\n            {\n                fname : 'info',\n                lname : 'info'\n            });\n    })\n    .post( function(req, res)\n    {\n        res.json(\n        {\n            fname: req.body.fname,\n            lname: req.body.lname,\n        })\n    })\n\n\n\ntest.route('/image')\n    .post( function(req, res)\n    {\n        S3.upload( req.body.image, { key:req.body.key } );\n\n        res.json(\n        {\n            url:'https://s3-us-west-2.amazonaws.com/glimpsing/'+req.body.key\n        })\n    });\ntest.post('/imagem', S3.multipart);\ntest.route('/imagem')\n    .post( function(req, res)\n    {\n\n\n                    res.json(req.body);\n\n\n    });\n\nmodule.exports = test"]}