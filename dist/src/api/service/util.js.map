{"version":3,"sources":["src/api/service/util.js"],"names":[],"mappings":"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","file":"src/api/service/util.js","sourcesContent":["var nconf = require('nconf');\n/*\n    Logger\n*/\nvar logLevel = process.env.LOGLEVEL || 'info',\n    winston = require('winston');\nvar Logentries = require('winston-logentries');\nvar Loggly = require('winston-loggly').Loggly;\n\nvar logger = new winston.Logger({\n    transports: [\n        new winston.transports.Console(\n        {\n            colorize: true,\n            level: logLevel,\n\n        })\n    /*\n    new winston.transports.Logentries({\n        token: '54360b32-87c6-4b3f-b932-ff258bee5e50',\n        level: logLevel\n    }),\n    new winston.transports.Loggly({\n             inputToken: 'a14bc370-6230-488a-82c5-b6b02a72f4f9',\n            json: true,\n            level: logLevel,\n            stripColors: true,\n            subdomain: 'neshorange',\n            tags: ['glimpse']\n    })*/\n    ],\n    exceptionHandlers: [\n      new winston.transports.Console(\n      {\n            colorize: true,\n            json: true\n      })\n    ]\n});\nprocess.on('uncaughtException', function (err) {\n    //logger.error('uncaughtException', { message : err.message, stack : err.stack }); // logging with MetaData\n    //process.exit(1); // exit with failure\n});\n\nlogger.exitOnError = false;\n\n\n\n\n\n\n\n\n\n\n\n\n/*\n    Validation\n*/\n\nvar validator = require('is-my-json-valid');\n\nvar route= function(resource, type)\n            {\n                return function(req,res,next)\n                {\n                    var validate = validator(nconf.get('validation')[resource][type]);\n                    validate(req.body)? next() : res.status( 400 ).json({ errs : validate.errors });\n                }\n            };\n\nvar action_token = function(req,res,next)\n                    {\n                        if(!req.body.action_token || !req.body.action_token.action)\n                        {\n                            res.status( 400 ).json({ errs : 'invalid action token' });\n                        }\n                        else{\n\n                            var validate = validator(nconf.get('validation').token['action'][req.body.action_token.action]);\n                            validate(req.body.action_token)? next() : res.status( 400 ).json({ errs : validate.errors });\n                        }\n                    };\nvar auth_token = function(req,res,next)\n                    {\n                        if(!req.body.auth_token)\n                        {\n          //                  console.log( 'res.body');\n        //                    console.log( req.body);\n                            res.status( 400 ).json({ errs : 'invalid auth token' });\n                        }\n                        else{\n    //                        console.log( 'res.body');\n      //                      console.log( req.body);\n                            var validate = validator(nconf.get('validation').token['auth']);\n                            validate(req.body.auth_token)? next() : res.status( 400 ).json({ errs : validate.errors });\n                        }\n                    };\n\n\n\n\n\n\n\nmodule.exports = {logger:logger,validator:{route:route, action_token:action_token,auth_token:auth_token}};\n"]}