{"version":3,"sources":["src/client/app.js"],"names":[],"mappings":"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","file":"src/client/app.js","sourcesContent":["\nvar unirest = require('unirest');\nvar uuid = require('node-uuid');\nvar async = require('async');\nvar array = require('array');\nvar PUBNUB = require('pubnub');\n\n\n/********************\n**  PUBNUB CLIENT  **\n*********************/\n\nvar PubnubClient=function(){\n  this.initStatus=false;\n  this.pubnub;\n}\nPubnubClient.prototype.init = function(params){\n  this.pubnub = PUBNUB.init({\n     publish_key: params.pubnub_pub_key,\n     subscribe_key: params.pubnub_sub_key,\n     auth_key:params.pubnub_auth_key,\n     origin: 'pubsub.pubnub.com',\n     ssl: true\n  });\n  this.initStatus=true;\n  console.log('PUBNUB initializingi.'+params);\n};\n\nPubnubClient.prototype.sub = function(channel, cb){\n    this.pubnub.subscribe({\n      channel: channel,\n     // windowing: 1000,\n      presence: (m)=>{console.log(m)},\n      callback:cb,\n      connect: ()=>{console.log(\"Connected to \"+channel)},\n      disconnect: ()=>{console.log(\"Disconnected\")},\n      reconnect: ()=>{console.log(\"Reconnected\")},\n      error: ()=>{console.log(\"Network Error\")}\n    });\n  };\n\n\nPubnubClient.prototype.pub = function(channel,msg){\n    this.pubnub.publish({\n         channel : channel,\n         message :msg\n     });\n    console.log('Publishing to channel '+channel);\n  };\n\n\n/*****************\n**  API CLIENT  **\n ****************/\n\nvar apiClient = function (device_info,env){\n  this.data=device_info;\n  this.env=env;\n  this.pn = new PubnubClient();\n\n  this.post = (endpoint, params, next)=>{\n    var url = this.data.baseURL[env||'prod']+endpoint;\n    params.auth_token = this.data.auth_token|| params.auth_token;\n    console.log('Sending POST to...'+url+ '\\n'+params);\n    unirest.post(url).header('Accept','application/json').send(params).end((response)=>{\n      console.log(response.body);\n      next(null,response.body);\n    });\n  };\n\n  this.postMulti = (endpoint, data, next)=>{\n    var url = this.data.baseURL[env||'prod']+endpoint;\n    console.log('Sending POST Multi to...'+url+ '\\n'+data);\n    unirest.post(url).field('lat',this.data.location.lat).field('lon',this.data.location.lon).field('auth_token',this.data.auth_token).attach('file',data.image).end((response)=>{\n      console.log(response.body);\n      next(null,response.body)\n    });\n  };\n\n  this.put = (endpoint, data, next)=>{\n    var url = this.data.baseURL[env||'prod']+endpoint;\n    data.auth_token = this.data.auth_token|| data.auth_token;\n    console.log('api put...');\n    unirest.put(url).header('Accept','application/json').send(data).end((response)=>{\n      console.log(response.body);\n      next(null,response.body);\n    })\n  }\n}\napiClient.prototype.initPubnub = function(){\n  this.pn.init({\n     publish_key: this.data.pubnub_pub_key,\n     subscribe_key: this.data.pubnub_sub_key,\n     auth_key:this.data.pubnub_auth_key\n  });\n  console.log('PUBNUB initialized.');\n};\n\napiClient.prototype.connectServer = function(){\n  this.pn.sub(this.data.channel_uuid,(msg)=>{\n        console.log(msg);\n        switch(msg.type){\n          case '001'://new logins from subscribtion\n            console.log(this.data.subscribe_list.items.find({uuid:msg.uuid}).moments);\n            console.log(this.data.subscribe_list.items.find({uuid:msg.uuid}));\n            this.data.subscribe_list.items.find({uuid:msg.uuid}).moments.push({\n              image_url:msg.image_url,\n              status:msg.status,\n              //timestamp:Date.now()\n            });\n\n            break;\n          case '002':\n            break;\n          case '003':\n            break;\n        };\n  });\n  console.log('Connecting server...');\n};\napiClient.prototype.backup = function(){\n  console.log('Soving some device info to server...');\n};\napiClient.prototype.pokeServer = function(){\n  this.pn.pub(this.data.channel_uuid);\n  console.log('Poking server...');\n};\n\n/***************\n**  LOGIN UI  **\n ***************/\n\nfunction LoginUI (apiClient){\n\n  this.api = apiClient;\n  this.photo = '';\n  this.status = '';\n\n  this.init_moment = function(photo,next){\n    console.log('init_moment...');\n    this.photo=photo;\n    this.api.postMulti('/moment',{image:photo||'./img.jpg'},\n      (err, response)=>{\n        console.log(response);\n        console.log('Update device info.');\n        this.api.data.auth_token=response.new_auth_token;\n        this.api.data.uuid = response.uuid;\n        if(next){\n          next();\n        }else{\n          console.log('Subscribing to server...');\n          this.api.connectServer();\n        }\n      });\n  };\n\n  this.submit_moment = function(status,next){\n\n    this.status=status || 'yo';\n    this.api.put('/moment', {status:status},(err, response)=>{\n      console.log('submit_moment...');\n      if(!next){\n        console.log(response);\n      }\n      if(!response.explore_list){\n        if(next)next('err');\n      }else{\n\n        this.api.data.explore_list.rePopulate(response.explore_list,()=>{\n          console.log('populating explore...');\n          if(next)next();\n        });\n      }\n\n    });\n  };\n\n};\n\n/****************************\n**  moment list data type  **\n ****************************/\n\nfunction moment_list(){\n  this.items = array();\n}\n\nmoment_list.prototype.rePopulate = function(info_list,next){\n  console.log('populate list itmes...');\n  //console.log(info_list);\n  this.items = array();\n  async.eachSeries(info_list,(i,next)=>{\n    this.items.push(i);\n    next();\n  },\n  (err)=>{next();}\n  );\n}\n\n/*****************\n**  EXPLORE UI  **\n *****************/\n\nfunction ExploreUI (apiClient){\n  this.api=apiClient;\n  this.api.data.explore_list.subscribe = (index, next)=>{\n    console.log('substribing to explore item: '+index);\n    var item = this.api.data.explore_list.items[index];\n    this.api.post('/moment/action', {action_token:item.action_token.subscribe},(response)=>{\n      this.api.data.subscribe_list.addItem(item);\n    });\n  }\n  this.nextPage = function(){\n    console.log('[POST api/explore/nextPage]');\n    return this\n  }\n  this.refresh = function(next){\n    this.api.post('/moment/explore', {auth_token:''},(err,response)=>\n      {\n        this.api.data.explore_list.rePopulate(response.explore_list,()=>\n        {\n          console.log('Refresh explore list...');\n          console.log(this.api.data)\n          next();\n        });\n      });\n  };\n};//eof\n\n\n/*******************\n**  SUBSCRIBE UI  **\n********************/\n\nfunction SubscribeUI(apiClient){\n  this.api=apiClient;\n  this.api.data.subscribe_list.addItem = (item)=>{\n    console.log('Adding '+item.status+ ' to subscribe list...');\n    this.api.data.subscribe_list.items.push({\n      uuid:item.uuid,\n      image_url:item.image_url,\n      distance:item.distance,\n      status:item.status,\n      nickname:'',\n      moments:new array()\n    })\n  };\n\n\n  this.nextPage = function(data){\n    console.log('api call to subscriber nextPage');\n    return this\n  }\n  this.refresh = function(data){\n    console.log('api call to subscriber refresh');\n    return this\n  }\n\n};//eof\n\n\n/***************\n**  MAIN APP  **\n****************/\n\nfunction App(params ,next){\n  this.data =\n  {\n    location:{lat:20,lon:11},\n    auth_token:'',\n    pubnub_pub_key:'demo',//'pub-c-59368519-7ab7-4419-afc0-6ed2cfa0b43d',\n    pubnub_sub_key:'demo',//'sub-c-6f5b3a4a-a4ad-11e4-a9d4-02ee2ddab7fe',\n    pubnub_auth_key:'',\n    channel_uuid:'',\n    baseURL:{\n      local:'http://127.0.0.1:8000/api',\n      prod:'http://glimpse-prod-env-a22zhqiyzs.elasticbeanstalk.com/api'\n    },\n    login_status:true,\n\n    subscribe_list:new moment_list(),\n    explore_list:new moment_list(),\n    chat_list:[],\n    self_list:[]\n  }\n  this.api = new apiClient(this.data, params?params.env : 'prod');\n\n  this.control = {\n    login:new LoginUI(this.api),\n    explore:new ExploreUI(this.api),\n    subscriber:new SubscribeUI(this.api),\n  }\n  this.init= function(next){\n\n    this.api.post('/device',{\n      auth_token:'new'\n    },(err,params)=>\n      {\n        this.data.auth_token = params.auth_token;\n        this.data.pubnub_auth_key = params.pubnub_key;\n        this.data.channel_uuid = params.uuid;\n        this.data.login_status = params.relogin;\n        this.api.initPubnub();\n        this.api.connectServer();\n\n        if(next)next();\n      }\n    );\n  };\n  this.init(next);\n}\n\nApp.prototype.move = function(){\n  this.data.location.lat += 1;\n  this.data.location.lon += 1;\n};\nApp.prototype.login = function(status, image, location){\n  this.data.location = location || this.data.location;\n  this.control.login.init_moment(image,()=>\n  {\n    setTimeout(()=>\n    {\n      this.control.login.submit_moment(status,()=>console.log(this));\n    },1000);\n  });\n};\n\nApp.prototype.v_exp = function(){\n  this.control.explore.refresh(()=>\n    console.log(this.data.explore_list.items)\n  );\n\n};\n\n\nApp.prototype.sub = function(index){\n  this.data.explore_list.subscribe(index,(item)=>{\n    console.log(response);\n  })\n};\n\nApp.prototype.v_sub = function(){\n  this.control.subscriber.refresh();\n};\n\nApp.prototype.v_info = function(){\n  this.api.post('/device/info',{},(device)=>{\n    console.log(device);\n  });\n};\n\nvar a;\na= new App({env:'local'},()=>{\n  console.log(a);\n});\n\n\n\nmodule.exports = App;\n//a.login('mc','./img.jpg')\n//\n"]}